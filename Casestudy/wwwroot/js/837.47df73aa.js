"use strict";(globalThis["webpackChunkvuecasestudy"]=globalThis["webpackChunkvuecasestudy"]||[]).push([[837],{2403:(t,e,a)=>{a.d(e,{G:()=>r,W:()=>l});const s="/api/",r=async t=>{let e,a=o();try{let r=await fetch(`${s}${t}`,{method:"GET",headers:a});e=await r.json()}catch(t){console.log(t),e={error:`Error has occured: ${t.message}`}}return e},l=async(t,e)=>{let a,r=o();try{let l=await fetch(`${s}${t}`,{method:"POST",headers:r,body:JSON.stringify(e)});a=await l.json()}catch(t){a=t}return a},o=()=>{const t=new Headers,e=JSON.parse(sessionStorage.getItem("customer"));return e?(t.append("Content-Type","application/json"),t.append("Authorization","Bearer "+e.token)):t.append("Content-Type","application/json"),t}},6837:(t,e,a)=>{a.r(e),a.d(e,{default:()=>P});var s=a(1347),r=a(7763);const l={class:"text-center"},o={class:"text-h6 text-positive q-mt-sm"},d={key:0},c={class:"q-mt-md q-pa-sm bg-white shadow-2",style:{"max-width":"90vw",margin:"auto"}},n={class:"text-h6"},i={class:"text-subtitle2"},u={class:"text-left"},k={class:"text-center"},g={class:"text-center"},p={class:"text-center"},x={class:"text-right"},h={class:"text-right"},b={class:"text-right"},m={style:{"background-color":"#f0f0f0"}},y={class:"text-right text-bold text-primary"};function v(t,e,a,v,L,f){const _=(0,s.g2)("q-avatar"),q=(0,s.g2)("q-item-section"),w=(0,s.g2)("q-item"),F=(0,s.g2)("q-card-section"),O=(0,s.g2)("q-separator"),C=(0,s.g2)("q-markup-table"),D=(0,s.g2)("q-btn"),A=(0,s.g2)("q-card-actions"),I=(0,s.g2)("q-card"),S=(0,s.g2)("q-dialog"),Q=(0,s.gN)("close-popup");return(0,s.uX)(),(0,s.CE)("div",l,[(0,s.bF)(_,{class:"q-mt-md",size:"100px",square:""},{default:(0,s.k6)((()=>e[1]||(e[1]=[(0,s.Lk)("img",{src:"/icons/CartIcon.png"},null,-1)]))),_:1}),e[8]||(e[8]=(0,s.Lk)("div",{class:"text-h4 q-mt-md text-blue-grey-9"},"Order History",-1)),(0,s.Lk)("div",o,[(0,s.eW)(" loaded "+(0,r.v_)(v.state.orders.length)+" order",1),1!==v.state.orders.length?((0,s.uX)(),(0,s.CE)("span",d,"s")):(0,s.Q3)("",!0)]),(0,s.Lk)("div",c,[(0,s.bF)(w,{class:"q-py-sm bg-grey-3"},{default:(0,s.k6)((()=>[(0,s.bF)(q,{class:"col-6 text-center text-bold"},{default:(0,s.k6)((()=>e[2]||(e[2]=[(0,s.eW)("ID")]))),_:1}),(0,s.bF)(q,{class:"col-6 text-center text-bold"},{default:(0,s.k6)((()=>e[3]||(e[3]=[(0,s.eW)("Date")]))),_:1})])),_:1}),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(v.state.orders,(t=>((0,s.uX)(),(0,s.CE)("div",{key:t.id},[(0,s.bF)(w,{clickable:"",class:"q-py-sm",onClick:e=>v.selectOrder(t.id)},{default:(0,s.k6)((()=>[(0,s.bF)(q,{class:"col-6 text-center"},{default:(0,s.k6)((()=>[(0,s.eW)((0,r.v_)(t.id),1)])),_:2},1024),(0,s.bF)(q,{class:"col-6 text-center"},{default:(0,s.k6)((()=>[(0,s.eW)((0,r.v_)(v.formatDate(t.orderDate)),1)])),_:2},1024)])),_:2},1032,["onClick"])])))),128))]),(0,s.bF)(S,{modelValue:v.state.showDialog,"onUpdate:modelValue":e[0]||(e[0]=t=>v.state.showDialog=t)},{default:(0,s.k6)((()=>[(0,s.bF)(I,{style:{"min-width":"400px"}},{default:(0,s.k6)((()=>[(0,s.bF)(F,{class:"text-center"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",n,"Order #"+(0,r.v_)(v.state.selectedOrderId),1),(0,s.Lk)("div",i,(0,r.v_)(v.state.selectedOrderDate),1)])),_:1}),(0,s.bF)(O),(0,s.bF)(F,null,{default:(0,s.k6)((()=>[(0,s.bF)(C,{flat:"",bordered:""},{default:(0,s.k6)((()=>[e[7]||(e[7]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",{class:"text-left",rowspan:"2"},"Name"),(0,s.Lk)("th",{class:"text-center",colspan:"3"},"Quantities"),(0,s.Lk)("th",{class:"text-right",rowspan:"2"},"Extended")]),(0,s.Lk)("tr",null,[(0,s.Lk)("th",{class:"text-center"},"S"),(0,s.Lk)("th",{class:"text-center"},"O"),(0,s.Lk)("th",{class:"text-center"},"B")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(v.state.selectedOrderItems,(t=>((0,s.uX)(),(0,s.CE)("tr",{key:t.productId},[(0,s.Lk)("td",u,(0,r.v_)(t.productName),1),(0,s.Lk)("td",k,(0,r.v_)(t.qtySold),1),(0,s.Lk)("td",g,(0,r.v_)(t.qtyOrdered),1),(0,s.Lk)("td",p,(0,r.v_)(t.qtyBackOrdered),1),(0,s.Lk)("td",x,"$"+(0,r.v_)(t.sellingPrice.toFixed(2)),1)])))),128)),(0,s.Lk)("tr",null,[e[4]||(e[4]=(0,s.Lk)("td",{colspan:"4",class:"text-right text-bold"},"Sub:",-1)),(0,s.Lk)("td",h,"$"+(0,r.v_)(v.state.subtotal.toFixed(2)),1)]),(0,s.Lk)("tr",null,[e[5]||(e[5]=(0,s.Lk)("td",{colspan:"4",class:"text-right text-bold"},"Tax(13%):",-1)),(0,s.Lk)("td",b,"$"+(0,r.v_)(v.state.tax.toFixed(2)),1)]),(0,s.Lk)("tr",m,[e[6]||(e[6]=(0,s.Lk)("td",{colspan:"4",class:"text-right text-bold text-primary"},"Total:",-1)),(0,s.Lk)("td",y,"$"+(0,r.v_)(v.state.total.toFixed(2)),1)])])])),_:1})])),_:1}),(0,s.bF)(A,{align:"right"},{default:(0,s.k6)((()=>[(0,s.bo)((0,s.bF)(D,{flat:"",label:"Close",color:"primary"},null,512),[[Q]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}a(939),a(6593);var L=a(4187),f=a(2403);const _=t=>{let e;e=void 0===t?new Date:new Date(Date.parse(t));let a=e.getDate(),s=e.getMonth()+1,r=e.getFullYear(),l=e.getMinutes();return l<10&&(l="0"+l),r+"-"+s+"-"+a},q={name:"OrderHistoryPage",setup(){const t=.13,e=JSON.parse(sessionStorage.getItem("customer")),a=(0,L.Kh)({orders:[],selectedOrderItems:[],selectedOrderId:null,selectedOrderDate:"",subtotal:0,tax:0,total:0,showDialog:!1});(0,s.sV)((async()=>{try{const t=await(0,f.G)(`order/${e.email}`);a.orders=t}catch(t){console.error("Error loading orders:",t)}}));const r=async s=>{try{const r=await(0,f.G)(`order/${s}/${e.email}`);a.selectedOrderId=s,a.selectedOrderItems=r,a.selectedOrderDate=r[0]?.orderDate||"",a.subtotal=r.reduce(((t,e)=>t+e.sellingPrice*e.qtySold),0),a.tax=a.subtotal*t,a.total=a.subtotal+a.tax,a.showDialog=!0}catch(t){console.error("Error loading order details:",t)}};return{state:a,selectOrder:r,formatDate:_}}};var w=a(2968),F=a(5305),O=a(2589),C=a(4958),D=a(2540),A=a(3341),I=a(222),S=a(6915),Q=a(4362),$=a(5034),E=a(9039),T=a(8657),N=a(272),W=a.n(N);const X=(0,w.A)(q,[["render",v]]),P=X;W()(q,"components",{QAvatar:F.A,QItem:O.A,QItemSection:C.A,QDialog:D.A,QCard:A.A,QCardSection:I.A,QSeparator:S.A,QMarkupTable:Q.A,QCardActions:$.A,QBtn:E.A}),W()(q,"directives",{ClosePopup:T.A})}}]);
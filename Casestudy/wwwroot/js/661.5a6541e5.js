"use strict";(globalThis["webpackChunkvuecasestudy"]=globalThis["webpackChunkvuecasestudy"]||[]).push([[661],{2403:(t,e,s)=>{s.d(e,{G:()=>r,W:()=>o});const a="/api/",r=async t=>{let e,s=l();try{let r=await fetch(`${a}${t}`,{method:"GET",headers:s});e=await r.json()}catch(t){console.log(t),e={error:`Error has occured: ${t.message}`}}return e},o=async(t,e)=>{let s,r=l();try{let o=await fetch(`${a}${t}`,{method:"POST",headers:r,body:JSON.stringify(e)});s=await o.json()}catch(t){s=t}return s},l=()=>{const t=new Headers,e=JSON.parse(sessionStorage.getItem("customer"));return e?(t.append("Content-Type","application/json"),t.append("Authorization","Bearer "+e.token)):t.append("Content-Type","application/json"),t}},4661:(t,e,s)=>{s.r(e),s.d(e,{default:()=>$});var a=s(1347),r=s(7763);const o={class:"text-center"},l={key:0,class:"q-pa-md"},n={class:"text-left"},c={class:"text-center"},i={class:"text-right"},d={class:"text-right"},p={class:"text-right"},u={class:"text-right"},g={style:{"background-color":"#f5f5f5"}},h={class:"text-right text-bold",style:{color:"#43a047"}},m={key:1,class:"text-blue text-subtitle1 q-mt-md"};function k(t,e,s,k,x,C){const y=(0,a.g2)("q-avatar"),b=(0,a.g2)("q-markup-table"),v=(0,a.g2)("q-btn");return(0,a.uX)(),(0,a.CE)("div",o,[e[5]||(e[5]=(0,a.Lk)("div",{class:"text-h4 q-mt-md text-blue-grey-9"},"Cart Contents",-1)),(0,a.bF)(y,{class:"q-mt-md",size:"100px",square:""},{default:(0,a.k6)((()=>e[0]||(e[0]=[(0,a.Lk)("img",{src:"/icons/CartIcon.png"},null,-1)]))),_:1}),k.state.shoppingCart.length>0?((0,a.uX)(),(0,a.CE)("div",l,[(0,a.bF)(b,{flat:"",bordered:"",class:"q-mt-lg",style:{"max-width":"90vw",margin:"0 auto"}},{default:(0,a.k6)((()=>[e[4]||(e[4]=(0,a.Lk)("thead",{style:{"background-color":"#37474f",color:"white"}},[(0,a.Lk)("tr",null,[(0,a.Lk)("th",{class:"text-left"},"Name"),(0,a.Lk)("th",{class:"text-center"},"Qty"),(0,a.Lk)("th",{class:"text-right"},"MSRP"),(0,a.Lk)("th",{class:"text-right"},"Extended")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(k.state.shoppingCart,(t=>((0,a.uX)(),(0,a.CE)("tr",{key:t.id},[(0,a.Lk)("td",n,(0,r.v_)(t.item.productName),1),(0,a.Lk)("td",c,(0,r.v_)(t.qty),1),(0,a.Lk)("td",i,"$"+(0,r.v_)(t.item.msrp.toFixed(2)),1),(0,a.Lk)("td",d,"$"+(0,r.v_)((t.item.msrp*t.qty).toFixed(2)),1)])))),128)),(0,a.Lk)("tr",null,[e[1]||(e[1]=(0,a.Lk)("td",{colspan:"3",class:"text-right text-bold"},"Sub:",-1)),(0,a.Lk)("td",p,"$"+(0,r.v_)(k.state.subtotal.toFixed(2)),1)]),(0,a.Lk)("tr",null,[e[2]||(e[2]=(0,a.Lk)("td",{colspan:"3",class:"text-right text-bold"},"Tax (13%):",-1)),(0,a.Lk)("td",u,"$"+(0,r.v_)(k.state.tax.toFixed(2)),1)]),(0,a.Lk)("tr",g,[e[3]||(e[3]=(0,a.Lk)("td",{colspan:"3",class:"text-right text-bold",style:{color:"#43a047"}},"Total:",-1)),(0,a.Lk)("td",h," $"+(0,r.v_)(k.state.total.toFixed(2)),1)])])])),_:1}),(0,a.bF)(v,{label:"Place Order",color:"deep-orange-5",onClick:k.saveCart,class:"q-mt-md"},null,8,["onClick"]),(0,a.bF)(v,{label:"Empty Cart",color:"deep-orange-5",icon:"remove_shopping_cart",onClick:k.clearCart,class:"q-mt-md"},null,8,["onClick"])])):((0,a.uX)(),(0,a.CE)("div",m,(0,r.v_)(k.state.status),1))])}s(939),s(7049),s(6593);var x=s(4187),C=s(2403);const y={name:"CartPage",setup(){const t=.13,e=(0,x.Kh)({shoppingCart:[],subtotal:0,tax:0,total:0}),s=async()=>{let t=JSON.parse(sessionStorage.getItem("customer")),s=JSON.parse(sessionStorage.getItem("shoppingCart"));try{if(e.status="Sending order to server...",!t||!s||0===s.length)return void(e.status="Cart or customer info is missing.");const a=s.map((t=>({qty:t.qty,product:t.item,sellingPrice:t.item.msrp}))),r={email:t.email,products:a};console.log("Posting to server:",r);let l=await(0,C.W)("order",r);if(console.log("Server response:",l),"string"===typeof l&&l.toLowerCase().startsWith("order")&&o(),"string"===typeof l){const t=l.match(/^Order\s+\d+/i);e.status=t?`${t[0]} created successfully.`:l}else e.status="Order created."}catch(t){console.error("Caught error:",t),e.status=`Error saving order: ${t.message||t}`}},r=()=>{e.subtotal=e.shoppingCart.reduce(((t,e)=>t+e.item.msrp*e.qty),0),e.tax=e.subtotal*t,e.total=e.subtotal+e.tax},o=()=>{sessionStorage.removeItem("shoppingCart"),e.shoppingCart=[]};return(0,a.sV)((()=>{const t=sessionStorage.getItem("shoppingCart");t&&(e.shoppingCart=JSON.parse(t),r())})),{state:e,clearCart:o,saveCart:s}}};var b=s(2968),v=s(5305),L=s(4362),f=s(9039),q=s(272),S=s.n(q);const w=(0,b.A)(y,[["render",k]]),$=w;S()(y,"components",{QAvatar:v.A,QMarkupTable:L.A,QBtn:f.A})}}]);